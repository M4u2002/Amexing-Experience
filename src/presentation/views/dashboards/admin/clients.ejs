<%
/**
 * Admin Clients Management Page
 * Follows main dashboard layout structure with atomic design components
 *
 * Layout Structure (matching main dashboard):
 * - Direct row/column structure (no body-wrapper)
 * - Container-fluid from Flexy Bootstrap
 * - Consistent spacing and alignment
 *
 * Note: DataTables CSS/JS libraries are loaded via controller (pageStyles & footerScripts)
 */

// Page configuration
const currentUserRole = typeof userRole !== 'undefined' ? userRole : 'admin';
const currentPath = '/dashboard/admin/clients';
%>

<!-- Page Header with Breadcrumb -->
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2 class="mb-1 fw-bold">Gestión de Clientes</h2>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item">
                            <a href="/dashboard/admin" class="text-decoration-none">
                                <i class="ti ti-home me-1"></i>Dashboard
                            </a>
                        </li>
                        <li class="breadcrumb-item active" aria-current="page">
                            <i class="ti ti-building me-1"></i>Clientes
                        </li>
                    </ol>
                </nav>
            </div>
            <div class="text-muted">
                <small class="d-block">Total clientes registrados</small>
                <strong id="total-clients-count">-</strong>
            </div>
        </div>
    </div>
</div>

<!-- Clients DataTable -->
<div class="row">
    <div class="col-12">
        <%- include('../../organisms/datatable/clients-table', {
            tableId: 'clients-table',
            apiEndpoint: '/api/clients',
            userRole: currentUserRole,
            showActions: true
        }) %>
    </div>
</div>

<!-- Client Management Modals -->
<!-- Create Client Modal -->
<div class="modal fade" id="createClientModal" tabindex="-1" aria-labelledby="createClientModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="createClientModalLabel">
                    <i class="ti ti-building-plus me-2"></i>Crear Nuevo Cliente
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Create client form will go here -->
                <p class="text-muted">Formulario de creación de cliente pendiente de implementar</p>
            </div>
        </div>
    </div>
</div>

<!-- Edit Client Modal -->
<div class="modal fade" id="editClientModal" tabindex="-1" aria-labelledby="editClientModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editClientModalLabel">
                    <i class="ti ti-edit me-2"></i>Editar Cliente
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Edit client form will go here -->
                <p class="text-muted">Formulario de edición de cliente pendiente de implementar</p>
            </div>
        </div>
    </div>
</div>

<!-- View Client Modal -->
<div class="modal fade" id="viewClientModal" tabindex="-1" aria-labelledby="viewClientModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="viewClientModalLabel">
                    <i class="ti ti-eye me-2"></i>Detalles de Cliente
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Client details will go here -->
                <p class="text-muted">Vista de detalles de cliente pendiente de implementar</p>
            </div>
        </div>
    </div>
</div>

<!-- Page-specific JavaScript -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Update total count when table loads (listen to custom event)
        document.addEventListener('clientsTableLoaded', function(e) {
            const count = e.detail?.count || 0;
            const countEl = document.getElementById('total-clients-count');
            if (countEl) {
                countEl.textContent = count;
            }
        });
    });
</script>
