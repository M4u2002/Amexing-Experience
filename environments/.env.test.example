# ==========================================
# Test Environment Configuration
# ==========================================
# SECURITY: This file contains FAKE credentials for documentation.
# Copy to .env.test and replace with REAL test IAM credentials.
# .env.test is in .gitignore and protected by pre-commit hooks.

# Node Environment
NODE_ENV=test
PORT=1340

# ====================
# Parse Server (MongoDB Memory Server)
# ====================
PARSE_APP_ID=test-app-id
PARSE_MASTER_KEY=test-master-key-change-in-real-env
PARSE_SERVER_URL=http://localhost:1339/parse
PARSE_PUBLIC_SERVER_URL=http://localhost:1339/parse

# Database (Auto-configured by MongoDB Memory Server)
DATABASE_URI=mongodb://localhost:27018/test-db

# ====================
# AWS S3 Test Configuration
# ====================
# CRITICAL: Create test-only IAM user with restricted policy
# Policy: docs/AWS_TEST_IAM_POLICY.json (only access to test/* prefix)
# Setup Guide: docs/AWS_TEST_CREDENTIALS.md

# AWS Credentials (FAKE EXAMPLE - Replace with real test credentials)
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
AWS_REGION=us-east-1

# S3 Bucket Configuration
S3_BUCKET=amexing-bucket
S3_PREFIX=test/                                  # CRITICAL: Test prefix only (never prod/ or dev/)

# S3 Security Configuration (PCI DSS Compliance)
S3_PRESIGNED_URL_EXPIRES=3600                   # 1 hour (PCI DSS 4.2.1)
S3_ENCRYPTION_TYPE=AES256                        # Server-side encryption (PCI DSS 3.5.1)
S3_KMS_KEY_ID=                                   # Optional: KMS key ID (leave empty for AES256)

# File Management
S3_DELETION_STRATEGY=move                        # Test soft deletion (move to deleted/test/)
MAX_FILE_SIZE_MB=1                              # Reduced for tests (1MB vs 250MB prod)
ALLOWED_FILE_TYPES=jpg,jpeg,png,pdf

# ====================
# Security Configuration (Relaxed for Testing)
# ====================
SESSION_SECRET=test-session-secret-at-least-32-characters-long
JWT_SECRET=test-jwt-secret-at-least-32-characters-long-for-testing
JWT_EXPIRES_IN=1h
REFRESH_TOKEN_EXPIRES_IN=7d
ENCRYPTION_KEY=test-32-character-encryption-key-test
BCRYPT_ROUNDS=4                                  # Faster tests (use 12 in production)

# Session Configuration
SESSION_TIMEOUT_MINUTES=30
COOKIE_SECURE=false                              # False for local http://localhost
COOKIE_SAME_SITE=lax

# Account Security (Relaxed for Testing)
MAX_LOGIN_ATTEMPTS=10
ACCOUNT_LOCKOUT_DURATION_MINUTES=5
PASSWORD_RESET_EXPIRATION_HOURS=24

# ====================
# Monitoring & Logging (Disabled for Testing)
# ====================
ENABLE_MONITORING=false
ENABLE_AUDIT_LOGGING=false
LOG_LEVEL=error                                  # Reduce noise during tests
ENABLE_PERFORMANCE_MONITORING=false

# ====================
# OAuth Configuration (Optional for S3 Tests)
# ====================
# Leave empty unless testing OAuth flows
APPLE_CLIENT_ID=
APPLE_TEAM_ID=
APPLE_KEY_ID=
APPLE_PRIVATE_KEY_PATH=

# ====================
# Cloud Code
# ====================
CLOUD_CODE_MAIN=./src/cloud/main.js

# ====================
# SETUP INSTRUCTIONS
# ====================
# 1. Copy this file:
#    cp environments/.env.test.example environments/.env.test
#
# 2. Edit .env.test and replace FAKE credentials with REAL test IAM credentials:
#    AWS_ACCESS_KEY_ID=AKIA_YOUR_REAL_TEST_KEY
#    AWS_SECRET_ACCESS_KEY=your_real_test_secret_key
#
# 3. Verify .env.test is protected:
#    git check-ignore environments/.env.test
#    # Should output: environments/.env.test
#
# 4. Run S3 integration tests:
#    yarn test tests/integration/api/vehicle-images-s3.test.js
#
# 5. See full documentation:
#    docs/AWS_TEST_CREDENTIALS.md
